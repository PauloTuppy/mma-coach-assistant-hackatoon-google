syntax = "proto3";

package mmacoach.recommendationservice;

import "common.proto";

// Recommendation service - Recommends other products based on what's given in the cart
// Written in Python

service RecommendationService {
  // Get product recommendations based on cart contents
  rpc ListRecommendations(ListRecommendationsRequest) returns (ListRecommendationsResponse);
  
  // Get recommendations based on user behavior
  rpc GetPersonalizedRecommendations(GetPersonalizedRecommendationsRequest) returns (GetPersonalizedRecommendationsResponse);
  
  // Get trending products
  rpc GetTrendingProducts(GetTrendingProductsRequest) returns (GetTrendingProductsResponse);
  
  // Get similar products
  rpc GetSimilarProducts(GetSimilarProductsRequest) returns (GetSimilarProductsResponse);
}

message ListRecommendationsRequest {
  string user_id = 1;
  repeated string product_ids = 2;
}

message ListRecommendationsResponse {
  repeated string product_ids = 1;
}

message GetPersonalizedRecommendationsRequest {
  string user_id = 1;
  repeated string category_filters = 2;
  int32 limit = 3;
}

message GetPersonalizedRecommendationsResponse {
  repeated ProductRecommendation recommendations = 1;
}

message ProductRecommendation {
  string product_id = 1;
  double confidence_score = 2;
  string reason = 3;
  mmacoach.common.Product product = 4;
}

message GetTrendingProductsRequest {
  string category = 1;
  int32 limit = 2;
  int32 time_window_hours = 3;
}

message GetTrendingProductsResponse {
  repeated TrendingProduct trending_products = 1;
}

message TrendingProduct {
  string product_id = 1;
  int32 view_count = 2;
  int32 purchase_count = 3;
  double trending_score = 4;
  mmacoach.common.Product product = 5;
}

message GetSimilarProductsRequest {
  string product_id = 1;
  int32 limit = 2;
}

message GetSimilarProductsResponse {
  repeated SimilarProduct similar_products = 1;
}

message SimilarProduct {
  string product_id = 1;
  double similarity_score = 2;
  mmacoach.common.Product product = 3;
}
